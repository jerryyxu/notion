### â” [å¦‚ä½• `node` ä¸­ä½¿ç”¨ `ES module`](<(https://nodejs.org/api/packages.html#packages_determining_module_system)>)

---

- æ–‡ä»¶ä»¥ `mjs` ç»“å°¾
- `package.json` æ–‡ä»¶ä¸­è®¾ç½® _type_ å­—æ®µä¸º `"module"`

- è®¾ç½® `node` è¿è¡Œå‚æ•° `--input-type=module`

### â” [ä»€ä¹ˆæ˜¯ commonjs2](https://github.com/webpack/webpack/issues/1114)

---

webpack é…ç½® `output.library.type` å±æ€§æ”¯æŒçš„ç±»å‹ä¸­åŒ…æ‹¬ `commonjs` å’Œ `commonjs2`ï¼Œä¸¤è€…çš„åŒºåˆ«æ˜¯ï¼š

<img src="../asserts/2021-08-09-12-58-13.png" alt="commonjs  vs commonjs2" width="720" />

### â• [React Diff ç®—æ³•](https://reactjs.org/docs/reconciliation.html#motivation)

React é€šè¿‡å‰åè™šæ‹Ÿ DOM æ ‘çš„æ¯”å¯¹ï¼Œè¿›è¡Œ DOM çš„æ›´æ–°ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå°†ä¸€æ£µæ ‘è½¬æ¢åˆ°å¦ä¸€ä¸ªæ ‘çš„æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n^3)ï¼ŒReact åŸºäºä¸‹é¢ä¸¤æ¡å‡è®¾å®ç°äº†å¯å‘å¼çš„æ—¶é—´å¤æ‚åº¦ O(n) çš„ç®—æ³•ï¼š

- ä¸¤ä¸ªå…ƒç´ ç±»å‹ä¸åŒç”Ÿæˆçš„æ ‘ä¹Ÿä¸åŒï¼Œå³ä¸å†æ¯”è¾ƒåä»£æ ‘èŠ‚ç‚¹
- å¼€å‘è€…å¯ä»¥é€šè¿‡è®¾ç½® key å±æ€§ï¼Œæ¥å‘ŠçŸ¥æ¸²æŸ“å“ªäº›å­å…ƒç´ åœ¨ä¸åŒçš„æ¸²æŸ“ä¸‹å¯èƒ½æ˜¯ç¨³å®šçš„

React Diff ç®—æ³•çš„æ¯”å¯¹è¿‡ç¨‹ï¼š

1. ç±»å‹ä¸åŒçš„ DOM å…ƒç´ ï¼Œé”€æ¯è€çš„æ ‘ï¼Œé‡æ–°æ„å»ºä¸€æ£µæ–°æ ‘
2. ç±»å‹ç›¸åŒçš„ DOM å…ƒç´ ï¼Œå¯¹æ¯”å±æ€§ï¼Œæ›´æ–°ä¿®æ”¹è¿‡çš„å±æ€§
3. ç±»å‹ç›¸åŒçš„ç»„ä»¶å…ƒç´ ï¼Œé€’å½’ `render()` æ–¹æ³•è¿”å›çš„ç»“æœ
4. é€’å½’å­å…ƒç´ ï¼Œå¦‚æœè®¾ç½® `key` å±æ€§ï¼Œé€šè¿‡ `key` å±æ€§æ¥åŒ¹é…

### â• [Render Blocking CSS](https://developers.google.com/web/fundamentals/performance/critical-rendering-path/render-blocking-css)

é»˜è®¤æƒ…å†µä¸‹ï¼ŒCSS æ˜¯å µå¡æ¸²æŸ“çš„èµ„æºï¼Œå› ä¸ºæµè§ˆå™¨éœ€è¦æ„å»ºå®Œ DOM å’Œ CSSOM ä¹‹åæ‰èƒ½ç”Ÿæˆæ¸²æŸ“æ ‘ã€‚å¯ä»¥é€šè¿‡åª’ä½“æŸ¥è¯¢çš„æ–¹å¼è®©ä¸ç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„ CSS èµ„æºå˜æˆéå µå¡çš„ã€‚eg:

```html
<link href="style.css" rel="stylesheet" media="all" />
<link href="portrait.css" rel="stylesheet" media="orientation:portrait" />
<link href="print.css" rel="stylesheet" media="print" />
<link href="other.css" rel="stylesheet" media="(min-width: 40em)" />
```

æ³¨æ„ï¼Œä¸æ»¡è¶³åª’ä½“æŸ¥è¯¢è°ƒæ•´çš„ CSS åªæ˜¯ä¸åœ¨åˆå§‹æ¸²æŸ“çš„æ—¶å€™å µå¡æ¸²æŸ“ï¼Œæµè§ˆå™¨è¿˜æ˜¯ä¼šåœ¨æ¸²æŸ“ç»“æŸä¹‹åç»§ç»­åŠ è½½èµ„æºã€‚

### â• [`queueMicrotask`](https://developer.mozilla.org/en-US/docs/Web/API/HTML_DOM_API/Microtask_guide)

`queueMicrotask` æ–¹æ³•å¯ä»¥å°†å›è°ƒ `push` åˆ° Microtask ä¸­ç­‰å¾…æ‰§è¡Œï¼š

```js
console.log("main begin");
setTimeout(() => console.log("timeout")ï¼Œ 0);
queueMicrotask(() => console.log("microtask"));
console.log("main end");

// output:
// main begin
// main end
// microtask
// timeout
```

### â• `setTimeout` + å¾ªç¯ vs `setInterval`

`setInterval` å¾ªç¯å®šæ—¶ä»»åŠ¡å¯ä»¥é€šè¿‡`setTimeout` + å¾ªç¯çš„æ–¹å¼å®ç°ç±»ä¼¼çš„é€»è¾‘ï¼ŒåŒºåˆ«åœ¨äº `setInterval` ä»»åŠ¡æ˜¯æ¯éš”ä¸€ä¸ª `delay` æ—¶é—´æ‰§è¡Œä¸€æ¬¡ï¼Œä¸åŒ…å«ä»»åŠ¡æ‰§è¡Œæ—¶é—´ï¼Œè€Œ `setTimeout` å› ä¸ºæ˜¯æ¯æ¬¡æ‰§è¡Œå®Œå½“å‰ä»»åŠ¡å†è¿è¡Œä¸€æ¬¡å®šæ—¶ä»»åŠ¡ï¼Œéœ€è¦é‡æ–°è®¡æ—¶ï¼Œæ‰€ä»¥å¤šä¸ªä¸€ä¸ªä»»åŠ¡æ—¶é—´ã€‚

<img src="../asserts/2021-08-21-12-24-49.png" alt="setInterval" width="540" />

<img src="../asserts/2021-08-21-12-25-10.png" alt="setTimeout" width="540" />

### â” [åŒæºç­–ç•¥](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy)

ä»€ä¹ˆæ˜¯åŒæºï¼šä¸¤ä¸ª URL çš„åè®® + ä¸»æœº + ç«¯å£éƒ½ç›¸åŒï¼Œåˆ™è¿™ä¸¤ä¸ª URL æ˜¯åŒæºã€‚
åŒæºç­–ç•¥æ˜¯æ§åˆ¶ä¸åŒæºä¹‹é—´çš„äº¤äº’ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå†™å’ŒåµŒå…¥çš„æ“ä½œæ˜¯å…è®¸çš„ï¼Œè¯»æ“ä½œæ˜¯ç¦æ­¢çš„ï¼Œæ¯”å¦‚

- JavaScript API çš„è®¿é—®ï¼š`iframe.contentWindow`ï¼Œ`window.open`
- `CanvasRenderingContext2D.drawImage` ä¸åŒç»˜åˆ¶ä¸åŒåŸŸçš„å›¾ç‰‡å†…å®¹
- Web Storage å’Œ IndexDB æ˜¯æŒ‰ç…§åŒæºè¿›è¡Œéš”ç¦»çš„ï¼Œä¹Ÿå°±æ˜¯é™åˆ¶ä¸åŒæºä¹‹é—´çš„è¯»å–ï¼ˆPS: Cookie æœ‰å•ç‹¬çš„å®šä¹‰ï¼‰

### â• [Why is typeof null â€œobjectâ€?](https://stackoverflow.com/questions/18808226/why-is-typeof-null-object)

JavaScript åŸå§‹ç±»å‹æœ‰ 7 ç§ï¼š

- `number`
- `string`
- `boolean`
- `symbol`
- `bigint`
- `null`
- `undefined`

è™½ç„¶ `null` æ˜¯åŸå§‹ç±»å‹ï¼Œä¸è¿‡` typeof null === 'object'` è¿™æ˜¯ JavaScript æ ‡å‡†çš„ä¸€ä¸ª bugã€‚

### â” [Math ä¸­çš„å–æ•´ API](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math)

|                       | -1.2 | -1.5 | 1.2 | 1.5 |
| --------------------- | ---- | ---- | --- | --- |
| `Math.ceil` å‘ä¸Šå–æ•´  | -1   | -1   | 2   | 2   |
| `Math.round` å››èˆäº”å…¥ | -1   | -1   | 1   | 2   |
| `Math.floor` å‘ä¸‹å–æ•´ | -2   | -2   | 1   | 1   |
| `Math.trunc` æˆªå–æ•´æ•° | -1   | -1   | 1   | 1   |

**ğŸ˜± æ³¨æ„å•Šï¼-0.5 å››èˆäº”å…¥ä¹‹åæ˜¯ 0**

### â• [`new` å…³é”®è¯](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new#description)

å…³é”®è¯ `new` ä¼šæ‰§è¡Œä¸‹é¢åŠ¨ä½œï¼š

- åˆ›å»ºä¸€ä¸ª blankã€plain JavaScript å¯¹è±¡ï¼ˆ`{}`ï¼‰
- å°†æ–°åˆ›å»ºå¯¹è±¡å®ä¾‹çš„ `__protot__` å±æ€§å€¼æŒ‡å‘æ„é€ å‡½æ•°çš„ `prototype` å¯¹è±¡
- ç»‘å®šæ–°åˆ›å»ºå¯¹è±¡å®ä¾‹ä½œä¸º `this` ä¸Šä¸‹æ–‡
- è¿”å› `this` å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ˆğŸ™ƒ å¦‚æœè¿”å›ä¸€ä¸ªåŸå§‹ç±»å‹æ•°æ®åˆ™å¿½ç•¥ï¼Œä¾ç„¶è¿”å› `this`ï¼‰

```js
function newObj(cstor, ...args) {
  const o = {};

  Object.setPrototypeOf(o, cstor.prototype);

  const returnVal = cstor.apply(o, args);

  if (returnVal instanceof Object) {
    return returnVal;
  }

  return this;
}
```
